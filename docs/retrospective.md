## 🧭 Retrospective – DocuFlow を作ってみての振り返り

DocuFlow 開発を通しての、簡単な振り返りメモです。  
設計判断・トレードオフ・今後の改善余地をまとめています。

---

## 1. 良かった設計判断

- **Supabase + RLS を前提に据えたこと**
  - 認証 / DB / RLS / Realtime を一体で扱えるため、「SaaS の土台」を短時間で用意できた。
  - Organizations / RBAC / Notifications など、マルチテナント前提の機能を素直に乗せられた。
- **Next.js 16 App Router + Server Components の積極利用**
  - ダッシュボードや設定画面など、データ取得の多いページを Server Component 化し、クライアント側の負荷を減らせた。
  - Server Actions によって、ドキュメント CRUD や設定変更のコードをシンプルに保てた。
- **品質ゲートを早めに導入したこと**
  - E2E（Playwright）、Lighthouse CI、Web Vitals、Supabase Migrations CI を入れたことで、  
    「あとから壊してしまう不安」を減らしつつ、安心して機能追加できた。

---

## 2. トレードオフ / 迷ったポイント

- **リアルタイム共同編集は見送った**
  - Yjs / CRDT ベースのリアルタイム編集も検討したが、スコープが大きくなりすぎるため今回はコメント + 通知に絞った。
  - 将来的に「DocuFlow 2.0」として別フェーズで取り組む前提にしている。
- **AI 機能は「まずは安定した体験」を優先**
  - モデル切り替え UI や複数プロバイダ（OpenAI / Anthropic など）の抽象化も検討したが、  
    デモとして分かりやすい「1 本の体験」を重視して、コード + env 管理に留めた。
- **大規模マルチテナントを最初からは狙わない**
  - Supabase 単一プロジェクト構成で、中小規模チーム向けのシナリオにフォーカス。
  - 数万テナント規模を想定した場合は、将来的に分割や別インフラを検討する余地を残している。

---

## 3. 今後の改善アイデア

- **2FA / SSO の本実装**
  - ADR と Security Design に沿って、実際の TOTP / SSO (Google Workspace / Entra ID) を段階的に導入したい。
- **ドキュメント間リンク・ナレッジグラフ的な UI**
  - 関連ドキュメントをグラフ的に辿れる UI を追加し、「読む」だけでなく「繋がりを発見する」体験を強化したい。
- **外部連携の拡張**
  - Slack / Teams 通知、Webhook、外部 BI ツール連携など、既存の `api/` と SDK を活かした拡張ポイントがある。

---

## 4. まとめ

短期間で「SaaS として形になるところ」までをゴールに、  
**機能・UI/UX・アーキテクチャ・品質・ドキュメント** をバランスよく揃えることを意識しました。

そのうえで、「やっていないこと」「今後やりたいこと」もはっきりさせることで、  
プロダクトとしてのスコープと伸びしろを説明しやすい状態にしています。


